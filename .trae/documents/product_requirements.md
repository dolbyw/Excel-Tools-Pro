# Excel Tools Pro - 产品需求文档

## 1. 产品概述

Excel Tools Pro 是一款基于 TAURI2 架构开发的桌面Excel处理工具，专注于提供高效的Excel文件合并、拆分和表头管理功能。

* 解决用户在处理大量Excel文件时的合并拆分需求，提供智能表头管理功能，帮助用户快速整理和处理Excel数据。

* 目标用户为需要频繁处理Excel文件的办公人员、数据分析师和企业用户。

* 产品定位为轻量级、高性能的专业Excel处理工具，追求极致的用户体验和处理效率。

## 2. 核心功能

### 2.1 用户角色

| 角色   | 注册方式      | 核心权限           |
| ---- | --------- | -------------- |
| 普通用户 | 直接使用，无需注册 | 可使用所有Excel处理功能 |

### 2.2 功能模块

我们的Excel处理工具采用单窗口设计，包含以下主要界面：

1. **主界面**：文件选择区域、操作控制面板、基本设置选项（保持界面小巧）
2. **处理进度界面**：进度显示、状态信息、简化的操作日志
3. **设置对话框**：必要的配置选项（最小化设置项，避免界面复杂）

### 2.3 界面详情

| 界面名称   | 模块名称   | 功能描述                              |
| ------ | ------ | --------------------------------- |
| 主界面    | 文件选择区域 | 支持拖拽上传Excel文件，显示简洁的文件列表，支持批量选择和删除 |
| 主界面    | 操作控制面板 | 提供合并、拆分操作按钮，简单的操作模式切换             |
| 主界面    | 基本设置区域 | 表头自动添加开关、表头去重开关、输出路径设置（最小化设置项）    |
| 处理进度界面 | 进度显示   | 实时显示处理进度条、当前处理文件名、剩余时间估算          |
| 处理进度界面 | 状态信息   | 显示处理状态、错误信息、成功完成数量                |
| 处理进度界面 | 简化日志   | 显示关键处理信息和错误提示（避免信息过载）             |
| 设置对话框  | 基本配置   | 表头管理、输出格式选择（保持选项简洁）               |
| 设置对话框  | 性能配置   | 内存使用限制、并发处理数量（高级用户选项，默认隐藏）        |

## 3. 核心流程

**主要用户操作流程：**

1. 用户启动应用进入主界面
2. 通过拖拽或点击选择需要处理的Excel文件
3. 在基本设置区域配置表头管理选项（自动添加表头、表头去重）
4. 选择操作模式（合并或拆分）并设置输出路径
5. 点击开始处理按钮，界面切换到处理进度显示
6. 实时查看处理进度和状态信息
7. 处理完成后显示结果摘要，可选择打开输出文件夹
8. 如有错误，在状态区域显示错误信息和重试选项

**简化错误处理流程：**

* 错误信息直接在主界面状态区域显示

* 提供一键重试功能，无需复杂的错误处理界面

* 系统自动保存处理进度，支持中断恢复

* 错误详情可通过工具提示或简单对话框查看

```mermaid
graph TD
  A[主界面] --> B[处理进度界面]
  A --> C[设置对话框]
  B --> A
  C --> A
  B --> D[错误提示]
  D --> B
```

## 4. 用户界面设计

### 4.1 设计风格

* **设计语言**：采用Microsoft Fluent Design设计语言，现代化且简洁

* **主色调**：深蓝色 (#0078D4) 作为主色，浅灰色 (#F3F2F1) 作为背景色

* **按钮样式**：现代化扁平按钮，具有微妙的阴影和悬停效果

* **字体**：Segoe UI字体系列，标题使用 16px，正文使用 14px，小字使用 12px

* **布局风格**：紧凑的单窗口布局，避免复杂的多级导航

* **图标风格**：使用Fluent UI图标库，简洁的线性图标风格

* **窗口尺寸**：固定窗口大小（800x500），保持界面小巧

### 4.2 界面设计概览

| 界面名称   | 模块名称   | UI元素                             |
| ------ | ------ | -------------------------------- |
| 主界面    | 文件选择区域 | 简洁的拖拽区域，文件列表使用紧凑的列表样式，显示文件名和状态图标 |
| 主界面    | 操作控制面板 | 大按钮设计，合并/拆分使用单选按钮组，操作按钮使用主题色     |
| 主界面    | 基本设置区域 | 最小化的设置选项，使用复选框和路径选择器，布局紧凑        |
| 处理进度界面 | 进度显示   | 线性进度条配合百分比显示，当前文件名显示在进度条下方       |
| 处理进度界面 | 状态信息   | 简洁的状态文本和图标，错误信息使用醒目的颜色标识         |
| 设置对话框  | 基本配置   | 标准的对话框布局，选项分组清晰，使用标准控件           |
| 设置对话框  | 高级选项   | 可折叠的高级选项区域，默认隐藏以保持界面简洁           |

### 4.3 窗口设计

产品采用固定窗口设计，确保界面小巧且一致：

* **固定尺寸**：800x500 像素，不支持调整大小

* **居中显示**：窗口在屏幕中央显示，提供最佳的用户体验

* **最小化支持**：支持最小化到系统托盘，节省桌面空间

* **无边框设计**：可选的无边框窗口样式，更加现代化

